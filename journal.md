# wordle.py 随笔

## 0 前言

23:00 Jul 12, 2023 夜晚降临的暴雨送走了几天的闷热, 我关闭了空调, 躺在阳台上让风带来清凉. 无意间玩上了 wordle, 觉得作为 qq bot 的一个 feat 每天和群友一起玩挺有趣的. 由于我使用的是 pycqhttp bot 框架, 需要用 python 来实现这个简单的游戏, 并且为 qq 群的使用场景进行一些优化.

在网上看到了 [RealPython 的教程](https://realpython.com/python-wordle-clone/), 于是就这么动工了. 由于我有 python 基础, 所以并不打算按照手把手的教程来, 而是跟着他的步骤自己实现.

虽然是个很简单的小游戏, 但在动手制作的过程中我作为一个初心者依然有很多收获. 于是决定顺便开一篇日记, 边写代码边写随笔.

## 1 实现基本功能

### 1.1 Guess a word

虽然我是有编程基础, 但平时苦于“简单的代码太简单, 复杂的项目又无从下手”的困境, 不知道如何做项目. 而今天我学到的第一件事就是 *iteratively building*.

在新建文件夹之前, 我脑海里有很多想法, 比如说每天第一个挑战单词提供 new york times 官方的, 之后便从词库中随机抽取, 再比如说设置一个记分板, 每天第一个完成 nytimes 挑战的便可获得一分, so on and so forth. 但是, 这些独立的 feat 每个实现起来都有不同的路径, 如果我从一开始就“多线作战”, 创建一个庞大复杂的项目, 那么这个简单的小游戏很快就会淹没在搜不完的资料, 数不清的 bug 中.

Iteratively building 就是从一个最简单的可运行的 prototype 开始, 通过一次次的**迭代**升级来更新更多的功能. 其实也就是避免消极的完美主义, 让开发的每一步都富有成效, 也顺便方便了 debug 和检查.

### 1.2 Refactor

#### 1.2.1 怎么重构

教程中这一步是 organize your code with functions, 但是我在前面编写代码的时候就已经将复杂重复的代码用函数封装. 教程中还将一些简单的代码也进行了封装, 个人认为没有什么必要, 不过这可能是编写大型项目时的好习惯, 这就在以后慢慢领悟吧.

但是重构还是必要的. 因为在第一步我只做出了能在本地运行的程序, 而目标是将其搭载到 qq bot 上, 每天提供一道题目供群友游玩. 未来还想做记分板这些, 但第一步是做出能在群里用的小游戏.

重构的一开始, 我想用 class 来封装游戏逻辑. 但考虑到目前打算的是每天只提供一道, 且由所有群有共同解题, 没有多个游戏同时运行的需要, 所以便放弃了.

后面打算按照教程里的思路, 利用函数封装复杂重复代码和 main loop. 用函数封装还有个好处就是方便使用 doctest 进行测试. 之前 CS61a 的作业题代码都使用了 doctest 来测试, 今天正好自己来写个 doctest 玩玩.

main loop 封装好后突然发现用 class 封装起来就是动动手指的事, 而且虽然暂时没有同时开多局游戏的需要, 但是能方便调整单词长度和可尝试次数也是好的, 所以最后还是用 class 制作了游戏的 prototype.

#### 1.2.2 函数要做好明确可靠的事

但是我发现, 封装的几个函数要么是依赖于读取的外部文件, 要么是包含随机生成, 没有固定的输出从而无法使用 doctest 进行测试. 不过教程在此时再次点醒了我. 由于函数将会在主程序中各个地方被多次调用, 我们应当确保函数有明确的作用和可靠的结果, 所以 best practice 是将读取文件和随机生成这种事情交给 main loop 去做, 而将结果作为参数传入函数.

#### 1.2.3 写出 elegent 的函数

`print_feedback()` 写得就一坨, 不像是 Python 的函数. 因为不知道怎么写, 所以就按照做 C 语言题的习惯来了. 不过可能在 C 语言中也称不上是漂亮的写法. 不过能实现目的就先这样, 之后想到如何修改后再更新日记.
